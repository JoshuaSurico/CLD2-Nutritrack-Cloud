<%- include('partials/header', { userId: true }) %>

<div class="space-y-8">
    <!-- 1. TOTAL CARDS (UX Point) -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 text-center">
            <p class="text-xs font-bold text-slate-400 uppercase">Calories</p>
            <p class="text-2xl font-black text-blue-600"><%= totals.kcal.toFixed(0) %> <span class="text-sm font-normal text-slate-400">/ <%= user.calorieGoal %></span></p>
        </div>
        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 text-center">
            <p class="text-xs font-bold text-slate-400 uppercase text-red-500">Protéines</p>
            <p class="text-xl font-bold"><%= totals.p.toFixed(1) %>g</p>
        </div>
        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 text-center">
            <p class="text-xs font-bold text-slate-400 uppercase text-yellow-500">Glucides</p>
            <p class="text-xl font-bold"><%= totals.g.toFixed(1) %>g</p>
        </div>
        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 text-center">
            <p class="text-xs font-bold text-slate-400 uppercase text-green-500">Lipides</p>
            <p class="text-xl font-bold"><%= totals.l.toFixed(1) %>g</p>
        </div>
    </div>

    <!-- 2. MEAL LIST -->
    <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
        <div class="p-6 border-b flex justify-between items-center">
            <h2 class="text-xl font-bold">Journal d'aujourd'hui</h2>
            <a href="/add-food" class="bg-blue-600 text-white px-4 py-2 rounded-lg font-bold">+ Ajouter</a>
        </div>
        
        <div class="divide-y">
            <% ['Petit-déjeuner', 'Déjeuner', 'Dîner', 'Collation'].forEach(type => { %>
                <div class="p-6">
                    <h3 class="font-bold text-slate-400 mb-4 uppercase text-xs tracking-widest"><%= type %></h3>
                    <% const mealItems = entries.filter(e => e.mealType === type) %>
                    <% if(mealItems.length === 0) { %>
                        <p class="text-slate-300 italic text-sm">Rien de noté...</p>
                    <% } %>
                    <% mealItems.forEach(item => { %>
                        <div class="flex justify-between items-center py-2">
                            <div>
                                <p class="font-bold text-slate-800"><%= item.foodName %></p>
                                <p class="text-xs text-slate-500"><%= item.quantity %>g</p>
                            </div>
                            <p class="font-bold text-blue-600"><%= item.calories.toFixed(0) %> kcal</p>
                        </div>
                    <% }) %>
                </div>
            <% }) %>
        </div>
    </div>
</div>